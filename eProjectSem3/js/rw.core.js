rw={};rw.init=function(A){var A=jQuery.extend({xml:"",current_album:0,thumb_size:"",tclass:"gallery-thumb"},A);globals={img:0,album:A.current_album,built:false,slideshow:"",flickr:{},type:"",imgpath:"../rw_common/themes/realmacsoftware2009/images/default.htm"};rw.build({xml:A.xml,tclass:A.tclass});x=0;check={i:0,init:function(){if(check.timer){clearTimeout(check.timer)}if(globals.built==true||check.i>200){rw.lightbox.init({tclass:A.tclass,thumb_size:A.thumb_size});return true}check.i++;check.timer=setTimeout("check.init()",10)}};check.init()};rw.build=function(E){var B=E;B.tclass=jQuery("."+B.tclass);globals.gallery={};jQuery("body").append(jQuery('<div id="lb-loading">Loading... Please wait...</div>'));var A=(jQuery("#lb-loading").height()/2)-jQuery(document).scrollTop();jQuery("#lb-loading").css({marginTop:-A,display:"block"}).animate({opacity:0.8},100);if(!B.xml){var D={};jQuery.each(B.tclass,function(H,I){D[H]={};D[H].id=H;D[H].type="image";if(jQuery(I).attr("title")){D[H].title=jQuery(I).attr("title")}if(jQuery(I).attr("href")){D[H].fullsize={url:jQuery(I).attr("href")}}var F="";if(jQuery(I).attr("rel")!="self"){F=jQuery(I).attr("rel");F=F.replace(/\[|\]|\s/gi,"");F=F.split(",");D[H].fullsize.width=parseInt(F[0]);D[H].fullsize.height=parseInt(F[1])}var J=/\.mov|../.mp4|\.avi/gi;if(J.test(D[H].fullsize.url)){D[H].qt={url:jQuery(I).attr("href"),width:D[H].fullsize.width,height:D[H].fullsize.height};D[H].type="movie"}var G=/\.swf|../.fla|youtube.com/gi;if(G.test(D[H].fullsize.url)){D[H].flash={url:jQuery(I).attr("href"),width:D[H].fullsize.width,height:D[H].fullsize.height};D[H].type="movie"}if(F[2]){D[H].fullsize.url=F[2]}});globals.gallery[0]=D;globals.built=true;jQuery("#lb-loading").animate({opacity:0},100).animate({opacity:0},100).css("display","none");return }else{flickr=/api.flickr.com/g;if(flickr.test(B.xml)){jQuery.getJSON(B.xml+"&jsoncallback=?",function(F){var G={};jQuery.each(F.items,function(I,J){var K=J.description.replace(/&lt;(.|\n)*?&gt;/g,"").replace("&amp;","&");var L=J.link.replace("http://","").split("/")[3];var H=J.media.m.replace("_m.jpg","_s.jpg");G[I]={id:I,title:J.title,description:K,fullsize:{},thumb:{width:75,height:75,url:H},flickr:{image:J.media.m,id:L}}});globals.gallery[0]=G;globals.gallery[0].title=F.title;globals.gallery[0].desc=F.description;globals.gallery[0].path="";globals.gallery[0].thumb=F.thumb;globals.gallery[0].flickr="true";jQuery("#lb-loading").animate({opacity:0},100).animate({opacity:0},100).css("display","none");globals.built=true})}else{jQuery.getJSON(B.xml,function(F){C(F)});function C(F){parseFlickr=false;jQuery.each(F.galleries,function(H,G){if(G.flickr){parseFlickr=true;jQuery.getJSON(G.flickr.rss+"&jsoncallback=?",function(J){var K={};jQuery.each(J.items,function(M,N){var O=N.description.replace(/&lt;(.|\n)*?&gt;/g,"").replace("&amp;","&");var P=N.link.replace("http://","").split("/")[3];var L=N.media.m.replace("_m.jpg","_s.jpg");K[M]={id:M,title:N.title,description:O,fullsize:{},thumb:{width:75,height:75,url:L},flickr:{image:N.media.m,id:P}}});globals.gallery[H]=K;globals.gallery[H].title=J.title;globals.gallery[H].desc=J.description;globals.gallery[H].path="";globals.gallery[H].thumb=J.thumb;globals.gallery[H].flickr="true";globals.built=true})}else{var I={};jQuery.each(G.media,function(J,K){I[J]=K});globals.gallery[H]=I;globals.gallery[H].title=F.galleries[H].title;globals.gallery[H].desc=F.galleries[H].description;globals.gallery[H].path=F.galleries[H].folder;globals.gallery[H].thumb=F.galleries[H].thumb}});jQuery("#lb-loading").animate({opacity:0},100).animate({opacity:0},100).css("display","none");if(parseFlickr!=true){globals.built=true}}}}};rw.isString=function(){if(typeof arguments[0]=="string"){return true}if(typeof arguments[0]=="object"){var A=arguments[0].constructor.toString().match(/string/i);return(A!=null)}return false};rw.getLength=function(){var A=0;jQuery.each(globals.gallery[globals.album],function(B,C){if(!rw.isString(C)&&C!=undefined){A++}});return A};rw.quicktime=function(F,A){if(F.qt){var D=new QTObject(F.qt.url,F.title,F.qt.width,F.qt.height);D.addParam("showlogo","false");D.addParam("autoplay","false");var C="<p class='error'>Quicktime does not appear to be installed please visit <a href='../../www.apple.com/quicktime/download/default.htm' title='Visit the Apple Quicktime site'>the Apple Quicktime homepage to download it</a>.</p>"}if(F.flash){var G=new SWFObject(F.flash.url,F.title,F.flash.width,F.flash.height,F.flash.version,"#3a414b");G.addParam("wmode","transparent");var C="<p class='error'>Flash does not appear to be installed please visit Adobes homepage to download it.</p>"}if(globals.type=="lightbox"){setTimeout(function(){var J=A.parent("div");A.hide();if(F.qt){var K='<div id="movie">'+C+"</div>";jQuery(K).prependTo(J).css({width:F.qt.width,height:F.qt.height,background:"#3a414b"});D.write("movie")}if(F.flash){var I=$rw('<div id="movie">'+C+"</div>").css({width:F.flash.width,height:F.flash.height,background:"#ffffff"});J.prepend(I);G.write("movie")}},800);rw.lightbox.slideshow.stop()}if(globals.type=="carousel"){var E=A.parent("li");A.remove();if(F.qt){var H=$rw('<div id="movie-'+F.id+'">'+C+"</div>");H.prepend(E).css({width:F.qt.width,height:F.qt.height});D.write("movie-"+F.id)}if(F.flash){var B=$rw('<div id="movie-'+F.id+'">'+C+"</div>").css({width:F.flash.width,height:F.flash.height});E.prepend(B);G.write("movie-"+F.id)}rw.slideshow.slideshow.stop()}};rw.outerWidth=function(B){var A=jQuery(B).width();A=rw.stripPX(jQuery(B).css("margin-left"))+A;A=rw.stripPX(jQuery(B).css("margin-right"))+A;A=rw.stripPX(jQuery(B).css("padding-right"))+A;A=rw.stripPX(jQuery(B).css("padding-left"))+A;A=rw.stripPX(jQuery(B).css("border-right-width"))+A;A=rw.stripPX(jQuery(B).css("border-left-width"))+A;return A};rw.stripPX=function(B){var A=parseInt(B.replace("px",""));if(isNaN(A)){A=0}return A};